<!-- public/login.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta property="og:locale" content="pt_BR" />
  <meta name="robots" content="noindex,nofollow,noarchive" />
  <title>Login — Influenciadores (Prováveis do Cartola FC)</title>

  <link rel="icon" href="/assets/img/icons/icon.ico" type="image/x-icon" />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/css/build/styles.css" />
 

  <style>
    :root{--panel:#0e1620;--line:#203044;--txt:#eaf3ff;--muted:#9bb0c9;--accent:#2ee59d;--danger:#ef4444}
    body{background:#070c12;color:var(--txt);min-height:100vh;display:flex;flex-direction:column}
    header{padding:18px 0}
    .login-wrap{flex:1;display:grid;place-items:center;padding:24px 16px}
    .login-card{width:100%;max-width:420px;background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:22px;box-shadow:0 24px 50px rgba(0,0,0,.45),inset 0 0 0 1px rgba(255,255,255,.02);position:relative}
    .login-card .brand{display:flex;justify-content:center;margin-bottom:6px}
    .login-card h1{font-size:1.15rem;margin:8px 0 14px;text-align:center;color:var(--txt)}
    .badge-invite{font-size:.7rem;font-weight:800;padding:3px 8px;border-radius:999px;color:#061a14;background:linear-gradient(135deg,#22d3ee,#2ee59d)}
    .form-label{color:var(--muted);font-weight:600;font-size:.92rem}
    .form-control{background:#0b1420;border:1px solid #1e2b3c;color:var(--txt)}
    .form-control:focus{border-color:#35527a;box-shadow:none}
    .btn-login{display:inline-flex;gap:8px;align-items:center;justify-content:center;width:100%;font-weight:800;background:linear-gradient(135deg,#22d3ee,#2ee59d);color:#06231a;border:0;border-radius:12px;padding:10px 14px;box-shadow:0 10px 24px rgba(46,229,157,.22)}
    .btn-login:active{transform:translateY(1px)}
    .helper{display:flex;justify-content:space-between;align-items:center;margin-top:8px;color:var(--muted);font-size:.9rem}
    .err{display:none;margin:10px 0 0;color:#fff;background:rgba(239,68,68,.14);border:1px solid rgba(239,68,68,.45);padding:8px 10px;border-radius:8px;font-size:.92rem}
    .hint{margin-top:10px;color:var(--muted);font-size:.86rem}
    .toggle-pass{cursor:pointer;user-select:none;background:none;border:0;color:#7dd3fc;padding:0}
    .toggle-pass:focus{outline:2px solid #35527a;outline-offset:2px}
    .login-footer-scope{background:#070c12;color:var(--txt);padding:28px 0 16px;text-align:center;border-top:1px solid #203044}
    .login-footer-scope .container{max-width:1280px;width:90%;margin:0 auto}
    .login-footer-scope .footer-text{font-size:1rem;color:var(--muted);margin-bottom:12px}
    .login-footer-scope .footer-small-text{font-size:.85rem;color:var(--muted);margin-top:6px}
    .exclusive-ribbon{position:sticky;top:0;z-index:5;text-align:center;background:linear-gradient(90deg,#0ea5b7 0%,#22d3ee 50%,#2ee59d 100%);color:#05161c;font-weight:900;letter-spacing:.3px;padding:6px 10px;box-shadow:0 8px 24px rgba(0,0,0,.35)}
    .exclusive-ribbon .lock{margin-right:6px}
    .exclusive-ribbon+header{margin-top:6px}
    .bg-vignette::before{content:"";position:fixed;inset:0;pointer-events:none;background:
      radial-gradient(80vw 60vh at 50% -10%,rgba(34,211,238,.12),transparent 60%),
      radial-gradient(50vw 40vh at 10% 110%,rgba(46,229,157,.10),transparent 60%),
      radial-gradient(50vw 40vh at 90% 110%,rgba(14,165,183,.10),transparent 60%)}
    body.bg-vignette{isolation:isolate}
    .login-card.live{border:1px solid transparent;background:
      linear-gradient(#0e1620,#0e1620) padding-box,
      linear-gradient(135deg,#22d3ee,#2ee59d) border-box;
      box-shadow:0 20px 60px rgba(46,229,157,.18),0 0 0 6px rgba(34,211,238,.06) inset}
    .live-pill{display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border-radius:999px;font-weight:800;font-size:.78rem;color:#061a14;background:linear-gradient(135deg,#fb7185,#f43f5e);box-shadow:0 10px 24px rgba(244,63,94,.25)}
    .live-dot{width:8px;height:8px;border-radius:50%;background:#fff;box-shadow:0 0 0 0 rgba(255,255,255,.8);animation:pulse 1.4s ease-in-out infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,255,255,.8)}70%{box-shadow:0 0 0 10px rgba(255,255,255,0)}100%{box-shadow:0 0 0 0 rgba(255,255,255,0)}}
    @media (prefers-reduced-motion:reduce){.live-dot{animation:none}}
    .live-meta{display:flex;gap:10px;justify-content:center;margin:8px 0 0;color:var(--muted);font-size:.88rem}
    .live-meta .sep{opacity:.4}
    .btn-login.live{background:linear-gradient(135deg,#f43f5e,#fb923c 45%,#2ee59d 100%);box-shadow:0 10px 28px rgba(244,63,94,.28),inset 0 0 0 1px rgba(255,255,255,.06)}
    .exclusive-note{margin-top:8px;color:#92a8c4;font-size:.8rem;text-align:center}
    .login-card::after{content:"EXCLUSIVO";position:absolute;top:10px;right:12px;font-size:.6rem;letter-spacing:.18em;color:rgba(234,243,255,.35);border:1px solid rgba(234,243,255,.18);padding:2px 6px;border-radius:999px}
  </style>

  <script>window.__CLEAN_PARAMS__ = false;</script>
  <script defer src="/assets/js/clean-params.js"></script>
</head>
<body>
  <div class="exclusive-ribbon">
    <i class="bi bi-shield-lock-fill lock"></i> Acesso exclusivo para convidados • LIVE de análises do Cartola FC
  </div>

  <header class="container" id="main-image-container">
    <div class="col-12 d-flex justify-content-center">
      <h1 id="header-especialista" class="custom-provaveis-item" style="margin:0">
        <span class="visually-hidden">Login Influenciadores</span>
        <img src="/assets/img/ui/provaveisdocartola_login.png" alt="" role="presentation" class="provaveis-image" width="520" height="180" loading="eager" decoding="async" />
      </h1>
    </div>
  </header>

  <main class="login-wrap">
    <section class="login-card">
      <div class="d-flex justify-content-center">
        <span class="live-pill" id="live-pill" hidden><span class="live-dot"></span> AO VIVO</span>
      </div>
      <div class="live-meta" id="live-meta" hidden>
        <span id="live-viewers">0 assistindo</span><span class="sep">•</span>
        <span>início <span id="live-start">--:--</span></span>
      </div>
      <p class="exclusive-note" id="live-ticker" hidden>Sincronizando com a sala…</p>

      <!-- FORM AGORA ENVIA PARA O BACKEND -->
      <form id="login-form" method="POST" action="/login" novalidate>
        <input type="hidden" name="next" id="nextField" value="/influencers.html" />

        <div class="mb-3">
          <label for="email" class="form-label">E-mail</label>
          <input
            type="email"
            inputmode="email"
            id="email"
            name="email"
            class="form-control"
            placeholder="seuemail@dominio.com"
            autocomplete="username"
            required
          />
        </div>

        <div class="mb-1">
          <label for="senha" class="form-label d-flex justify-content-between">
            <span>Senha</span>
            <button type="button" class="toggle-pass" id="toggle-pass" aria-controls="senha" aria-expanded="false">mostrar</button>
          </label>
          <div class="input-group">
            <input
              type="password"
              id="senha"
              name="password"
              class="form-control"
              placeholder="••••••••••"
              autocomplete="current-password"
              required
            />
          </div>
        </div>

        <div id="err" class="err" role="alert" aria-live="polite">Credenciais inválidas.</div>

        <div class="helper">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="remember">
            <label class="form-check-label" for="remember">manter conectado</label>
          </div>
          <span class="hint">Dica: use seu e-mail cadastrado.</span>
        </div>

        <div class="mt-3">
          <button type="submit" class="btn btn-login" id="btn-login">
            <i class="bi bi-box-arrow-in-right"></i> Entrar
          </button>
        </div>
      </form>

      <p class="hint mt-3">Se tiver dificuldade no login, contate um administrador.</p>
    </section>
  </main>

  <footer class="login-footer-scope">
    <div class="container">
      <p class="footer-text">Desenvolvida para facilitar o trabalho dos influenciadores em suas lives e análises do Cartola FC.</p>
      <p class="footer-small-text">© 2025 Prováveis do Cartola | Todos os direitos reservados</p>
    </div>
  </footer>

  <script>
  (function(){
    const params = new URLSearchParams(window.location.search);

    // next (redirect após login)
    const nextField = document.getElementById('nextField');
    const nextParam = params.get('next') || '/influencers.html';
    if (nextField) nextField.value = nextParam;

    // mensagens de erro vindas do servidor (?error=1/2/3)
    const errParam = params.get('error');
    const errBox = document.getElementById('err');
    if (errParam && errBox) {
      let msg = 'Não foi possível realizar o login.';
      if (errParam === '1') msg = 'E-mail ou senha inválidos.';
      else if (errParam === '2') msg = 'Este e-mail não está autorizado para acesso.';
      else if (errParam === '3') msg = 'Erro interno ao processar o login. Tente novamente.';
      errBox.textContent = msg;
      errBox.style.display = 'block';
    }

    // foco inicial no e-mail
    const emailInput = document.getElementById('email');
    if (emailInput) emailInput.focus();

    // toggle mostrar/ocultar senha
    const passInput = document.getElementById('senha');
    const toggle = document.getElementById('toggle-pass');
    if (passInput && toggle) {
      toggle.addEventListener('click', () => {
        const isText = passInput.type === 'text';
        passInput.type = isText ? 'password' : 'text';
        toggle.textContent = isText ? 'mostrar' : 'ocultar';
        toggle.setAttribute('aria-expanded', String(!isText));
      });
    }

    // validação mínima no front (só pra UX)
    const form = document.getElementById('login-form');
    if (form && errBox) {
      form.addEventListener('submit', (e) => {
        if (!emailInput.value.trim() || !passInput.value.trim()) {
          e.preventDefault();
          errBox.textContent = 'Preencha e-mail e senha.';
          errBox.style.display = 'block';
        }
      });
    }

    // MODO LIVE (visual, igual antes)
    const LIVE = params.get('live') === '1';
    if (LIVE) {
      const card   = document.querySelector('.login-card');
      const pill   = document.getElementById('live-pill');
      const meta   = document.getElementById('live-meta');
      const btn    = document.getElementById('btn-login');
      const ticker = document.getElementById('live-ticker');

      if (card && pill && meta && btn && ticker) {
        document.body.classList.add('bg-vignette');
        card.classList.add('live');
        btn.classList.add('live');
        btn.innerHTML = '<i class="bi bi-broadcast-pin"></i> Entrar na LIVE';
        pill.hidden = false;
        meta.hidden = false;
        ticker.hidden = false;

        const start = new Date();
        const hh = String(start.getHours()).padStart(2, '0');
        const mm = String(start.getMinutes()).padStart(2, '0');
        const liveStartEl = document.getElementById('live-start');
        if (liveStartEl) liveStartEl.textContent = `${hh}:${mm}`;

        let viewers = 128 + Math.floor(Math.random() * 40);
        const viewersEl = document.getElementById('live-viewers');
        if (viewersEl) {
          viewersEl.textContent = `${viewers} assistindo`;
          setInterval(() => {
            viewers += (Math.random() < .5 ? -1 : 1) * Math.floor(Math.random() * 3);
            viewers = Math.max(1, viewers);
            viewersEl.textContent = `${viewers} assistindo`;
          }, 3000);
        }

        let dots = 0;
        setInterval(() => {
          dots = (dots + 1) % 4;
          ticker.textContent = 'Sincronizando com a sala' + '.'.repeat(dots);
        }, 900);
      }
    }
  })();
  </script>
</body>
</html>
